
<VirtualHost *:80>
    ServerAdmin webmaster@localhost
    DocumentRoot /var/www/html

    <Directory /var/www/app> 
        Options +Indexes +FollowSymlinks
        Order Allow,Deny
        Allow from all
    </Directory> 

    RewriteEngine On
    RewriteCond %{HTTPS} !=On
    RewriteRule (.*) https://%{HTTP_HOST}%{REQUEST_URI} [END,NE,R=permament]

</VirtualHost>

<IfModule mod_ssl.c>
    <VirtualHost *:443> 
        DocumentRoot /var/www/html
        WSGIDaemonProcess python_http processes=2 threads=15 display-name=%{GROUP}
        WSGIProcessGroup python_http
        WSGIScriptAlias /app /var/www/app/app.wsgi
        WSGIScriptReloading On

        SSLOptions +StdEnvVars +ExportCertData 

        <Directory /var/www/app> 
            WSGIApplicationGroup %{GLOBAL}
            Order Allow,Deny
            Allow from all
        </Directory> 

        SSLEngine on
        SSLCertificateFile ssl/cert.pem
        SSLCertificateKeyFile ssl/cert.key

        <FilesMatch "\.(cgi|shtml|phtml|php)$">
            SSLOptions +StdEnvVars
        </FilesMatch>

        <Directory /usr/lib/cgi-bin>
            SSLOptions +StdEnvVars
        </Directory>

    </VirtualHost>
</IfModule>



